<!DOCTYPE html>
<html>
<% include partials/head %>
<% include partials/adminHeader %>
<body>
<div class="container">
    <% include partials/breadcrumb %>
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Bestellungen</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <% var monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]; %>
                    <% var currentMonth = monthNames[new Date().getMonth()]; %>
                    Bestellübersicht <%= currentMonth %>
                </div>
                <div class="panel-body">
                    <div class="dataTable_wrapper">
                        <table width="100%" class="table table-striped table-bordered table-hover"
                               id="dataTables-example">
                            <thead>
                            <tr id="ordersTableHead">
                                <th>Anlass</th>
                                <th>Kunde</th>
                                <th>Artikel</th>
                                <th>Menge</th>
                                <th>Auftragsdatum</th>
                                <th>Fällig in</th>
                                <th>Freigeben</th>
                            </tr>
                            </thead>
                            <tbody id="orderOverview">
                            <script>initOrdersOverview()</script>
                            <tr class="odd gradeX">
                                <td>Anlass 1</td>
                                <td>Kunde 1</td>
                                <td>Rezept 1</td>
                                <td>1</td>
                                <td class="center">26. August 2016</td>
                                <td class="center">7 Tagen</td>
                                <td class="center"><a class="ordersOverviewRelease" href="#"><span class="glyphicon glyphicon-ok"></span></a></td>
                            </tr>
                            <tr class="even gradeC">
                                <td>Anlass 2</td>
                                <td>Kunde 2</td>
                                <td>Rezept 2</td>
                                <td>2</td>
                                <td class="center">31. August 2016</td>
                                <td class="center">14 Tagen</td>
                                <td class="center"><a class="ordersOverviewRelease" href="#"><span class="glyphicon glyphicon-ok"></span></a></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- /.table-responsive -->
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
</div>

<script>
    $('.ordersOverviewRelease').on('click', function (e) {
        e.preventDefault();
        var singleOrder = $(this).parents("tr:first");
        var fields = $('#ordersTableHead');
        var json = {};

        $.each(singleOrder[0].cells, function (i) {
            json["" + fields[0].cells[i].innerText.toLocaleLowerCase()] = "" + singleOrder[0].cells[i].innerText;
        });
        var orderDetails = JSON.stringify(json);

        insertIntoOrdersTable(orderDetails);
        singleOrder.remove();

        if ($('#orderOverview').has("td").length == 0) {
            var emptyTable =
                    '<tr class="odd gradeX">' +
                    '<td colspan="' + singleOrder[0].cells.length + '"> Keine offenen Bestellungen! </td>' +
                    '</tr>';
            $('#orderOverview').append(emptyTable);
        }
    });
</script>
</body>
<% include partials/footer %>
</html>